<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Japanese Time Practice</title>

  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* Small tweak so the input's Enter key works smoothly on mobile */
    input:focus { outline: none; }
    .icon { width: 1.25rem; height: 1.25rem; }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center p-4">

  <div class="bg-white rounded-2xl shadow-xl p-8 max-w-md w-full" id="app">
    <div class="text-center mb-8">
      <div class="flex items-center justify-center gap-2 mb-2">
        <svg class="icon text-blue-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden>
          <circle cx="12" cy="12" r="9"></circle>
          <path d="M12 7v5l3 3"></path>
        </svg>
        <h1 class="text-3xl font-bold text-gray-800">Time Practice</h1>
      </div>
      <p class="text-gray-600">Japanese Midterm Prep</p>
    </div>

    <div class="bg-gradient-to-br from-blue-100 to-purple-100 rounded-xl p-8 mb-6">
      <div class="text-center">
        <div id="displayTime" class="text-6xl font-bold text-gray-800 mb-2">12:00</div>
        <p class="text-gray-600 text-sm">What time is this in Japanese?</p>
      </div>
    </div>

    <div id="formArea" class="space-y-4">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Your answer (romaji):</label>
        <input id="answerInput" type="text" placeholder="e.g., goji gofun" autofocus
               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
      </div>
      <button id="checkBtn"
              class="w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-semibold py-3 rounded-lg transition-colors"
      >
        Check Answer
      </button>
    </div>

    <div id="resultArea" class="hidden space-y-4">
      <div id="resultBox" class="p-4 rounded-lg bg-green-50 border-2 border-green-500">
        <div class="flex items-center gap-2 mb-2">
          <span id="resultIcon"></span>
          <span id="resultText" class="font-bold text-green-800 text-lg">Correct!</span>
        </div>
        <div class="text-sm text-gray-700">
          <p class="mb-1"><strong>Your answer:</strong> <span id="userAnsText"></span></p>
          <p><strong>Correct answer:</strong> <span id="correctAnsText"></span></p>
        </div>
      </div>

      <button id="nextBtn" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 rounded-lg transition-colors flex items-center justify-center gap-2">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="23 4 23 10 17 10"></polyline>
          <polyline points="1 20 1 14 7 14"></polyline>
          <path d="M3.51 9a9 9 0 0114.13-3.36L23 10"></path>
          <path d="M20.49 15a9 9 0 01-14.13 3.36L1 14"></path>
        </svg>
        Next Question
      </button>
    </div>

    <div class="mt-8 p-4 bg-gray-50 rounded-lg">
      <button id="refToggle" class="w-full text-left font-semibold text-gray-800 mb-2 text-sm flex items-center justify-between hover:text-blue-600 transition-colors">
        <span>Quick Reference</span>
        <span id="refSign" class="text-lg">+</span>
      </button>
      
      <div id="reference" class="text-xs text-gray-600 space-y-1 mt-2 hidden">
        <p>• Hours: ichiji (1), niji (2), sanji (3), yoji (4), goji (5), rokuji (6)</p>
        <p>• shichiji (7), hachiji (8), kuji (9), juuji (10), juuichiji (11), juuniji (12)</p>
        <p>• <strong>Minutes (fun/pun):</strong></p>
        <p>• 5: gofun, 10: juppun, 15: juugofun</p>
        <p>• 20: nijuppun, 25: nijuugofun</p>
        <p>• 30: sanjuppun (or <strong>han</strong>)</p>
        <p>• 35: sanjuugofun, 40: yonjuppun</p>
        <p>• 45: yonjuugofun, 50: gojuppun, 55: gojuugofun</p>
      </div>
    </div>
  </div>

  <script>
    (function () {
      // Hours array matches the React component order (0 = reiji, 1 = ichiji, ...)
      const hours = ['juuniji', 'ichiji', 'niji', 'sanji', 'yoji', 'goji', 'rokuji',
               'shichiji', 'hachiji', 'kuji', 'juuji', 'juuichiji'];
      
      const minutes = {
        0: '',
        5: 'gofun',
        10: 'juppun',
        15: 'juugofun',
        20: 'nijuppun',
        25: 'nijuugofun',
        30: 'sanjuppun',
        35: 'sanjuugofun',
        40: 'yonjuppun',
        45: 'yonjuugofun',
        50: 'gojuppun',
        55: 'gojuugofun'
      };
      const minuteValues = Object.keys(minutes).map(Number);

      // DOM elements
      const displayTime = document.getElementById('displayTime');
      const answerInput = document.getElementById('answerInput');
      const checkBtn = document.getElementById('checkBtn');
      const formArea = document.getElementById('formArea');
      const resultArea = document.getElementById('resultArea');
      const resultBox = document.getElementById('resultBox');
      const resultIcon = document.getElementById('resultIcon');
      const resultText = document.getElementById('resultText');
      const userAnsText = document.getElementById('userAnsText');
      const correctAnsText = document.getElementById('correctAnsText');
      const nextBtn = document.getElementById('nextBtn');
      const refToggle = document.getElementById('refToggle');
      const reference = document.getElementById('reference');
      const refSign = document.getElementById('refSign');

      let current = { hour: 0, minute: 0 };
      let correctAnswer = '';

      function pad(n) { return String(n).padStart(2, '0'); }

      function formatTime(hour, minute) {
        const displayHour = hour === 0 ? 12 : hour;
        return displayHour + ':' + pad(minute);
      }

      function generateTime() {
        const hour = Math.floor(Math.random() * 12); // 0-11
        const randomIndex = Math.floor(Math.random() * minuteValues.length);
        const minute = minuteValues[randomIndex];
        
        current = { hour, minute };
        displayTime.textContent = formatTime(hour, minute);

        // prepare correct answer
        let ans = hours[hour];
        const minuteString = minutes[minute];
        if (minuteString) {
          ans += ' ' + minuteString;
        }
        correctAnswer = ans; // This will be the 'sanjuppun' version

        // reset UI
        answerInput.value = '';
        userAnsText.textContent = '';
        correctAnsText.textContent = '';
        toggleToForm();
        answerInput.focus();
      }

      function normalize(s) {
        return String(s || '').toLowerCase().trim().replace(/\s+/g, ' ');
      }

      // EDITED: This function now checks for 'han' as well
      function checkAnswer() {
        const user = normalize(answerInput.value);
        const correct = normalize(correctAnswer);
        let isCorrect = (user === correct);
        let displayCorrect = correctAnswer; // Default display answer

        // Special check for 30 minutes to also allow 'han'
        if (current.minute === 30) {
          const hanAnswer = normalize(hours[current.hour] + ' han');
          if (user === hanAnswer) {
            isCorrect = true;
          }
          // Always show both options for 30 minutes
          displayCorrect = correctAnswer + ' / ' + hours[current.hour] + ' han';
        }

        // set result UI
        userAnsText.textContent = answerInput.value || '—';
        correctAnsText.textContent = displayCorrect; // Use the (potentially modified) display answer

        if (isCorrect) {
          resultBox.className = 'p-4 rounded-lg bg-green-50 border-2 border-green-500';
          resultIcon.innerHTML = `
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 6L9 17l-5-5"></path>
            </svg>
          `;
          resultText.className = 'font-bold text-green-800 text-lg';
          resultText.textContent = 'Correct!';
        } else {
          resultBox.className = 'p-4 rounded-lg bg-red-50 border-2 border-red-500';
          resultIcon.innerHTML = `
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          `;
          resultText.className = 'font-bold text-red-800 text-lg';
          resultText.textContent = 'Not quite!';
        }

        toggleToResult();
      }

      function toggleToResult() {
        formArea.classList.add('hidden');
        resultArea.classList.remove('hidden');
      }

      function toggleToForm() {
        resultArea.classList.add('hidden');
        formArea.classList.remove('hidden');
      }

      // Events
      checkBtn.addEventListener('click', function () {
        if (answerInput.value.trim()) checkAnswer();
      });

      nextBtn.addEventListener('click', generateTime);

      answerInput.addEventListener('input', function () {
        checkBtn.disabled = !answerInput.value.trim();
      });

      answerInput.addEventListener('keypress', function (e) {
        if (e.key === 'Enter') {
          e.preventDefault();
          if (answerInput.value.trim()) checkAnswer();
        }
      });

      refToggle.addEventListener('click', function () {
        const isHidden = reference.classList.contains('hidden');
        if (isHidden) {
          reference.classList.remove('hidden');
          refSign.textContent = '−';
        } else {
          reference.classList.add('hidden');
          refSign.textContent = '+';
        }
      });

      // initial
      generateTime();
    })();
  </script>
</body>
</html>
